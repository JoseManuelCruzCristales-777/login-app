import{A as m,B as C,D as p,G as d,H as i,Ha as y,I as n,Ja as T,K as b,Ka as I,L as u,M as g,R as o,S as c,T as f,U as h,aa as O,ba as M,da as P,ja as w,la as S,q as v,r as x,y as a}from"./chunk-XDF4ABNC.js";function D(r,t){if(r&1&&(i(0,"span",14),o(1),n()),r&2){let e=g();a(),h(" \u{1F464} ",e.user.first_name," ",e.user.last_name," ")}}function V(r,t){r&1&&(i(0,"div",15),o(1," Cargando tus tareas... "),n())}function W(r,t){if(r&1&&(i(0,"div",16),o(1),n()),r&2){let e=g();a(),f(" ",e.error," ")}}function z(r,t){r&1&&(i(0,"div",17)(1,"div",18),o(2,"\u{1F4DD}"),n(),i(3,"h3"),o(4,"No tienes tareas asignadas"),n(),i(5,"p"),o(6,"Actualmente no hay tareas asignadas a ti en este workspace"),n()())}function F(r,t){if(r&1&&(i(0,"p",34),o(1),n()),r&2){let e=g().$implicit;a(),c(e.description)}}function B(r,t){if(r&1){let e=b();i(0,"div",29)(1,"div",30)(2,"h4"),o(3),n()(),p(4,F,2,1,"p",31),i(5,"div",32)(6,"label"),o(7),n(),i(8,"input",33),u("change",function(l){let _=v(e).$implicit,k=g(2);return x(k.updateProgress(_,l))}),n()()()}if(r&2){let e=t.$implicit;a(3),c(e.title),a(),d("ngIf",e.description),a(3),f("Progreso: ",e.progress,"%"),a(),d("value",e.progress)}}function N(r,t){if(r&1&&(i(0,"p",34),o(1),n()),r&2){let e=g().$implicit;a(),c(e.description)}}function $(r,t){if(r&1){let e=b();i(0,"div",35)(1,"div",30)(2,"h4"),o(3),n()(),p(4,N,2,1,"p",31),i(5,"div",32)(6,"label"),o(7),n(),i(8,"input",33),u("change",function(l){let _=v(e).$implicit,k=g(2);return x(k.updateProgress(_,l))}),n()()()}if(r&2){let e=t.$implicit;a(3),c(e.title),a(),d("ngIf",e.description),a(3),f("Progreso: ",e.progress,"%"),a(),d("value",e.progress)}}function j(r,t){if(r&1&&(i(0,"p",34),o(1),n()),r&2){let e=g().$implicit;a(),c(e.description)}}function R(r,t){if(r&1&&(i(0,"div",36)(1,"div",30)(2,"h4"),o(3),n(),i(4,"span",37),o(5,"\u2705"),n()(),p(6,j,2,1,"p",31),i(7,"div",32)(8,"span",38),o(9),n()()()),r&2){let e=t.$implicit;a(3),c(e.title),a(3),d("ngIf",e.description),a(3),f("Completada (",e.progress,"%)")}}function A(r,t){if(r&1&&(i(0,"div",19)(1,"div",20)(2,"div",21)(3,"h3"),o(4,"\u{1F4CB} Pendientes"),n(),i(5,"span",22),o(6),n()(),i(7,"div",23),p(8,B,9,4,"div",24),n()(),i(9,"div",20)(10,"div",25)(11,"h3"),o(12,"\u26A1 En Progreso"),n(),i(13,"span",22),o(14),n()(),i(15,"div",23),p(16,$,9,4,"div",26),n()(),i(17,"div",20)(18,"div",27)(19,"h3"),o(20,"\u2705 Completadas"),n(),i(21,"span",22),o(22),n()(),i(23,"div",23),p(24,R,10,3,"div",28),n()()()),r&2){let e=g();a(6),c(e.getTasksByStatus("todo").length),a(2),d("ngForOf",e.getTasksByStatus("todo")),a(6),c(e.getTasksByStatus("in-progress").length),a(2),d("ngForOf",e.getTasksByStatus("in-progress")),a(6),c(e.getTasksByStatus("done").length),a(2),d("ngForOf",e.getTasksByStatus("done"))}}var E=class r{constructor(t,e,s,l){this.route=t;this.router=e;this.taskService=s;this.teamService=l}workspaceId=0;user=null;tasks=[];teams=[];loading=!0;error="";readOnlyMessage="\u{1F441}\uFE0F Modo solo lectura - Solo puedes ver las tareas asignadas a ti";ngOnInit(){this.workspaceId=Number(this.route.snapshot.paramMap.get("id")),this.loadUserData()}loadUserData(){let t=localStorage.getItem("user");t?(this.user=JSON.parse(t),console.log("Usuario viewer cargado:",this.user),this.loadUserTasks()):this.error="No se pudo cargar la informaci\xF3n del usuario"}loadUserTasks(){this.loading=!0,this.error="",this.taskService.getTasks().subscribe({next:t=>{this.tasks=t.filter(e=>e.workspace_id===this.workspaceId),this.loading=!1,console.log("Tareas del usuario en este workspace:",this.tasks.length)},error:t=>{console.error("Error al cargar tareas:",t),this.error="Error al cargar las tareas",this.loading=!1}})}getTaskStatus(t){return t.is_done||t.progress===100?"done":t.progress>0?"in-progress":"todo"}getTasksByStatus(t){return this.tasks.filter(e=>this.getTaskStatus(e)===t)}goBack(){this.router.navigate(["/workspace-list"])}updateTaskProgress(t,e){if(e<0||e>100)return;let s={progress:e,is_done:e===100};this.taskService.updateTask(t.id,s).subscribe({next:()=>{t.progress=e,t.is_done=e===100,console.log("Progreso actualizado:",t.title,e+"%")},error:l=>{console.error("Error al actualizar progreso:",l),this.error="Error al actualizar el progreso de la tarea"}})}updateProgress(t,e){let s=e.target,l=parseInt(s.value,10)||0;this.updateTaskProgress(t,l)}static \u0275fac=function(e){return new(e||r)(m(w),m(S),m(T),m(I))};static \u0275cmp=C({type:r,selectors:[["app-workspace-viewer"]],decls:19,vars:6,consts:[[1,"workspace-viewer"],[1,"viewer-header"],[1,"header-left"],[1,"back-btn",3,"click"],[1,"header-right"],["class","user-info",4,"ngIf"],[1,"viewer-content"],[1,"readonly-banner"],[1,"readonly-icon"],[1,"readonly-text"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],["class","no-tasks",4,"ngIf"],["class","kanban-board",4,"ngIf"],[1,"user-info"],[1,"loading"],[1,"error-message"],[1,"no-tasks"],[1,"no-tasks-icon"],[1,"kanban-board"],[1,"kanban-column"],[1,"column-header","pending"],[1,"task-count"],[1,"tasks-list"],["class","task-card pending",4,"ngFor","ngForOf"],[1,"column-header","in-progress"],["class","task-card in-progress",4,"ngFor","ngForOf"],[1,"column-header","done"],["class","task-card done",4,"ngFor","ngForOf"],[1,"task-card","pending"],[1,"task-header"],["class","task-description",4,"ngIf"],[1,"task-progress"],["type","range","min","0","max","100",1,"progress-slider",3,"change","value"],[1,"task-description"],[1,"task-card","in-progress"],[1,"task-card","done"],[1,"completed-badge"],[1,"progress-complete"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"header",1)(2,"div",2)(3,"button",3),u("click",function(){return s.goBack()}),o(4,"\u2190 Volver"),n(),i(5,"h1"),o(6,"\u{1F4CB} Workspace - Modo Lectura"),n()(),i(7,"div",4),p(8,D,2,2,"span",5),n()(),i(9,"main",6)(10,"div",7)(11,"span",8),o(12,"\u{1F441}\uFE0F"),n(),i(13,"span",9),o(14),n()(),p(15,V,2,0,"div",10)(16,W,2,1,"div",11)(17,z,7,0,"div",12)(18,A,25,6,"div",13),n()()),e&2&&(a(8),d("ngIf",s.user),a(6),c(s.readOnlyMessage),a(),d("ngIf",s.loading),a(),d("ngIf",s.error),a(),d("ngIf",!s.loading&&!s.error&&s.tasks.length===0),a(),d("ngIf",!s.loading&&!s.error&&s.tasks.length>0))},dependencies:[P,O,M,y],styles:[".workspace-viewer[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.viewer-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 2rem;background:#0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.viewer-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.viewer-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:#fff3;border:1px solid rgba(255,255,255,.3);color:#fff;padding:.5rem 1rem;border-radius:6px;cursor:pointer;transition:all .3s ease}.viewer-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.viewer-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600}.viewer-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{background:#fff3;padding:.5rem 1rem;border-radius:20px;font-size:.9rem}.viewer-content[_ngcontent-%COMP%]{padding:2rem}.readonly-banner[_ngcontent-%COMP%]{background:#ffc107e6;color:#856404;padding:1rem;border-radius:8px;margin-bottom:2rem;display:flex;align-items:center;gap:.75rem}.readonly-banner[_ngcontent-%COMP%]   .readonly-icon[_ngcontent-%COMP%]{font-size:1.25rem}.readonly-banner[_ngcontent-%COMP%]   .readonly-text[_ngcontent-%COMP%]{font-weight:500}.loading[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{text-align:center;padding:2rem;background:#ffffff1a;border-radius:8px;margin:2rem 0}.error-message[_ngcontent-%COMP%]{background:#dc354533;border:1px solid rgba(220,53,69,.4)}.no-tasks[_ngcontent-%COMP%]{text-align:center;padding:3rem;background:#ffffff1a;border-radius:12px}.no-tasks[_ngcontent-%COMP%]   .no-tasks-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.no-tasks[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:1rem 0 .5rem;font-size:1.5rem}.no-tasks[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fffc;margin:0}.kanban-board[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:2rem;margin-top:2rem}.kanban-column[_ngcontent-%COMP%]{background:#ffffff1a;border-radius:12px;padding:1rem;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.column-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:2px solid rgba(255,255,255,.2)}.column-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem}.column-header[_ngcontent-%COMP%]   .task-count[_ngcontent-%COMP%]{background:#fff3;padding:.25rem .75rem;border-radius:12px;font-size:.8rem;font-weight:600}.column-header.pending[_ngcontent-%COMP%]{border-bottom-color:#ffc107}.column-header.in-progress[_ngcontent-%COMP%]{border-bottom-color:#17a2b8}.column-header.done[_ngcontent-%COMP%]{border-bottom-color:#28a745}.tasks-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.task-card[_ngcontent-%COMP%]{background:#fffffff2;color:#333;padding:1rem;border-radius:8px;box-shadow:0 2px 8px #0000001a;border-left:4px solid}.task-card.pending[_ngcontent-%COMP%]{border-left-color:#ffc107}.task-card.in-progress[_ngcontent-%COMP%]{border-left-color:#17a2b8}.task-card.done[_ngcontent-%COMP%]{border-left-color:#28a745}.task-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:.75rem}.task-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1rem;color:#2c3e50;line-height:1.4}.task-header[_ngcontent-%COMP%]   .completed-badge[_ngcontent-%COMP%]{font-size:1.2rem}.task-description[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem;margin:0 0 1rem;line-height:1.4}.task-progress[_ngcontent-%COMP%]{margin-top:1rem}.task-progress[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.85rem;font-weight:500;color:#495057;margin-bottom:.5rem}.task-progress[_ngcontent-%COMP%]   .progress-slider[_ngcontent-%COMP%]{width:100%;height:6px;border-radius:3px;outline:none;background:#e9ecef;cursor:pointer}.task-progress[_ngcontent-%COMP%]   .progress-slider[_ngcontent-%COMP%]::-webkit-slider-thumb{appearance:none;width:18px;height:18px;border-radius:50%;background:#007bff;cursor:pointer;box-shadow:0 2px 4px #0003}.task-progress[_ngcontent-%COMP%]   .progress-slider[_ngcontent-%COMP%]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:#007bff;cursor:pointer;border:none;box-shadow:0 2px 4px #0003}.task-progress[_ngcontent-%COMP%]   .progress-complete[_ngcontent-%COMP%]{color:#28a745;font-weight:500;font-size:.9rem}@media (max-width: 768px){.viewer-header[_ngcontent-%COMP%]{padding:1rem;flex-direction:column;gap:1rem}.viewer-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:.5rem}.viewer-content[_ngcontent-%COMP%]{padding:1rem}.kanban-board[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}}"]})};export{E as WorkspaceViewerComponent};
